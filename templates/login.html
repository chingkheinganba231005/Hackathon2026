{% extends "base.html" %}

{% block title %}Login - Career Hub{% endblock %}

{% block content %}
<div class="auth-page">
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h1>Welcome Back</h1>
                <p>Login to access your career resources</p>
            </div>

            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" class="form-control" id="email" placeholder="your@email.com" required>
                </div>

                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-control" id="password" placeholder="Enter your password" required>
                </div>

                <div class="error-message" id="errorMsg" style="display:none;"></div>

                <button type="submit" class="btn btn-primary btn-full" id="loginBtn">Login</button>
            </form>

            <div class="auth-links">
                <p>Don't have an account? <a href="/register">Sign up here</a></p>
            </div>
        </div>

        <div class="auth-side">
            <div class="auth-side-content">
                <h2>Navigate Your Career</h2>
                <p>Join thousands of HK university students exploring career paths, building skills, and landing dream jobs.</p>
                <ul class="auth-features">
                    <li>&#x2713; Career path matching for 8+ industries</li>
                    <li>&#x2713; Self-assessment & personalized planning</li>
                    <li>&#x2713; Job search with real-time listings</li>
                    <li>&#x2713; Community experience sharing</li>
                    <li>&#x2713; Dream job & company rankings</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function handleLogin(e) {
    e.preventDefault();
    const btn = document.getElementById('loginBtn');
    const errMsg = document.getElementById('errorMsg');

    btn.textContent = 'Logging in...';
    btn.disabled = true;
    errMsg.style.display = 'none';

    fetch('/api/login', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
            email: document.getElementById('email').value,
            password: document.getElementById('password').value
        })
    })
    .then(r => r.json())
    .then(data => {
        if (data.success) {
            window.location.href = data.redirect || '/';
        } else {
            errMsg.textContent = data.message;
            errMsg.style.display = 'block';
            btn.textContent = 'Login';
            btn.disabled = false;
        }
    })
    .catch(() => {
        errMsg.textContent = 'Network error. Please try again.';
        errMsg.style.display = 'block';
        btn.textContent = 'Login';
        btn.disabled = false;
    });
}
</script>
{% endblock %}
