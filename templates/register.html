{% extends "base.html" %}

{% block title %}Sign Up - Career Hub{% endblock %}

{% block content %}
<div class="auth-page">
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h1>Create Account</h1>
                <p>Start your career journey today</p>
            </div>

            <form id="registerForm" onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" class="form-control" id="email" placeholder="your@email.com" required>
                </div>

                <div class="form-group">
                    <label>Password</label>
                    <input type="password" class="form-control" id="password" placeholder="At least 6 characters" required minlength="6">
                </div>

                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm your password" required>
                </div>

                <div class="error-message" id="errorMsg" style="display:none;"></div>

                <button type="submit" class="btn btn-primary btn-full" id="registerBtn">Create Account</button>
            </form>

            <div class="auth-links">
                <p>Already have an account? <a href="/login">Login here</a></p>
            </div>
        </div>

        <div class="auth-side">
            <div class="auth-side-content">
                <h2>Join Our Community</h2>
                <p>Connect with students from Hong Kong's top 8 universities and build your career together.</p>
                <div class="university-logos">
                    <span>HKU</span>
                    <span>CUHK</span>
                    <span>HKUST</span>
                    <span>PolyU</span>
                    <span>CityU</span>
                    <span>HKBU</span>
                    <span>LingnanU</span>
                    <span>EdUHK</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function handleRegister(e) {
    e.preventDefault();
    const btn = document.getElementById('registerBtn');
    const errMsg = document.getElementById('errorMsg');

    const password = document.getElementById('password').value;
    const confirm = document.getElementById('confirmPassword').value;

    if (password !== confirm) {
        errMsg.textContent = 'Passwords do not match';
        errMsg.style.display = 'block';
        return;
    }

    btn.textContent = 'Creating account...';
    btn.disabled = true;
    errMsg.style.display = 'none';

    fetch('/api/register', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
            email: document.getElementById('email').value,
            password: password,
            confirm_password: confirm
        })
    })
    .then(r => r.json())
    .then(data => {
        if (data.success) {
            window.location.href = data.redirect || '/profile';
        } else {
            errMsg.textContent = data.message;
            errMsg.style.display = 'block';
            btn.textContent = 'Create Account';
            btn.disabled = false;
        }
    })
    .catch(() => {
        errMsg.textContent = 'Network error. Please try again.';
        errMsg.style.display = 'block';
        btn.textContent = 'Create Account';
        btn.disabled = false;
    });
}
</script>
{% endblock %}
